@model List<SBS_Ecommerce.Models.User>

@{
    ViewBag.Title = "Account Manager";
    Layout = "~/Views/Admin/_LayoutAdmin.cshtml";
}

<div class="row2">
    <div class="main-content">
        <div class="install-theme">
            <button class="btn btn-success" onclick="PushToMailChimp()">Push to Mailchimp</button>
            @*<input value="Upload" class="clr-btn-success" type="button"  style="margin-top:10px;text-align:right">*@
        </div>
        <table class="table table-striped table-hover table-fw-widget dataTable no-footer">
            <thead>
                <tr>
                    <th class="col-xm-1">Avatar</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Email</th>
                    <th>Push Status</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
            {
                    <tr>
                        <td>
                            @if (!string.IsNullOrEmpty(item.Avatar))
                            {
                                <img src="@Url.Content(item.Avatar)" style="width: 50px; height: 50px" />
                            }
                            else
                            {
                                <img src="~/Content/Admin/img/default_avatar.png" style="width: 50px; height: 50px" />
                            }
                        </td>
                        <td>
                            @item.FirstName
                        </td>
                        <td>
                            @item.LastName
                        </td>
                        <td>
                            @item.Email
                        </td>
                        <td>
                            @(item.PushMailChimp != null ? item.PushMailChimp : false)
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
<script>
    $(function () {
        $("table").dataTable();
    });

    function PushToMailChimp() {
        $.ajax({
            url: '@Url.Action("PushToMailChimp","Admin")',
            data: {},
            success: function (rs) {
                if (rs == true) {
                    $.gritter.add({
                        title: 'Notification',
                        text: 'Push email to mailchimp successful',
                        class_name: 'color success'
                    });
                }
                else {
                    $.gritter.add({
                        title: 'Notification',
                        text: 'Please config apikey mailchimp',
                        class_name: 'color danger'
                    });
                }

            }
        });
    }
</script>
